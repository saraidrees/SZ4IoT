#include "main.h"

int main(int argc, char* argv[])
{


  SZ_Init(NULL);
  errorBoundMode = REL;
  confparams_cpr->errorBoundMode = errorBoundMode;
  confparams_cpr->relBoundRatio= 0.003;




  int nbEle=256;
  float *data=(float*)malloc(nbEle*sizeof(float));
  for( int i=0;i< nbEle;i++) {
    data[i]=2*(0.2*i+sin(i));
    printf("%f ",data[i]);
  }
  printf("\n");


  int r1=0,r2=0,r3=0,r4=0,r5=0;
  r1=nbEle;

  size_t outSize;
  unsigned char *bytes;
  bytes = SZ_compress(SZ_FLOAT, data, &outSize, r5, r4, r3, r2, r1);

  for(int i=0;i<outSize;i++)
    printf("%i ",bytes[i]);
  printf("\n");

    size_t byteLength=outSize;
    float *data2 = (float*) SZ_decompress(SZ_FLOAT, bytes, byteLength, r5, r4, r3, r2, r1);

    for(int i=0;i<nbEle;i++)
        printf("%f ",data2[i]);
    printf("\n");


}
